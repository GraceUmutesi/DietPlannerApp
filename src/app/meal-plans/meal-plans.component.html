<div class="ptop-component pbottom-component" id="body">
  <div class="row">
    <div class="col-md-3 meal-plans-col">
      <div class="meal-plans-wrapper">
        <div class="meal-plans-content-wrapper">
          <div class="meal-plans-title">
            <p class="text-color larger-text">My Meal Plans</p>
          </div>

          <div class="mtop-10" *ngFor="let mp of mealPlans">
            <mat-card class="full-width clickable" (click)="selectMealPlan(mp)">
              <mat-card-content>
                <p class="larger-text margin-0 text-color">{{mp.name}}</p>
                <p class="smaller-text lighter-text color-primary">Created at: {{mp.created_at | date: 'MMM dd yyyy, HH:mm'}}</p>
              </mat-card-content>
            </mat-card>
          </div>

        </div>
      </div>
    </div>
    <div class="col-md-9 meal-plans-col">
      <div class="selected-meal-plan-wrapper">
        <div class="meal-plan-content-wrapper" *ngIf="selectedMealPlanId != ''">
          <div class="">
            <h4 class="color-primary lighter-text center-text">{{selectedMealPlan?.name}}</h4>
          </div>
          <div class="alert alert-danger mtop-15" role="alert" *ngIf="showGlobalError">
            {{globalError}}
          </div>
          <div class="mtop-30">
            <table class="table table-striped table-borderless">
              <thead>
                <tr class="center-text">
                  <th scope="col"></th>
                  <th scope="col">MONDAY</th>
                  <th scope="col">TUESDAY</th>
                  <th scope="col">WEDNESDAY</th>
                  <th scope="col">THURSDAY</th>
                  <th scope="col">FRIDAY</th>
                  <th scope="col">SATURDAY</th>
                  <th scope="col">SUNDAY</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <th scope="row">Breakfast</th>

                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Monday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Tuesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Wednesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Thursday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Friday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Saturday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.breakfast">
                      <div class="day-meal" *ngIf="dm.day == 'Sunday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Lunch</th>

                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Monday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Tuesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Wednesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Thursday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Friday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Saturday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.lunch">
                      <div class="day-meal" *ngIf="dm.day == 'Sunday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                </tr>
                <tr>
                  <th scope="row">Dinner</th>
                  
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Monday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Tuesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Wednesday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Thursday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Friday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Saturday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                  <td class="day-recip-wrapper">
                    <span *ngFor="let dm of selectedMealPlanMeals?.dinner">
                      <div class="day-meal" *ngIf="dm.day == 'Sunday'">
                        <img *ngIf="dm.recipe_image != 'null'" src="{{dm.recipe_image}}" alt="" class="img img-fluid recipe-img clickable" (click)="goToRecipe(dm)">
                        <img *ngIf="dm.recipe_image == 'null'" src="../../assets/img/Your meal planner.png" alt="" class="img img-fluid recipe-img-2 clickable" (click)="goToRecipe(dm)">
                        <p class="margin-0 text-color clickable" (click)="goToRecipe(dm)">{{dm.recipe_name}}</p>
                        <button mat-icon-button color="warn" aria-label="Deleted mp" (click)="deleteMealPlanItem(dm)">
                          <mat-icon>cancel</mat-icon>
                        </button>
                      </div>
                    </span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="">
            <h5 class="text-color lighter-text">Grocery List</h5>
            <p class="text-color bolder-text margin-0">The following grocery list is for {{nbrOfServings}} person serving</p>
          </div>

          <div class="row mtop-10">
            <div class="col-md-1">
              <mat-form-field class="full-width">
                <mat-label>Servings</mat-label>
                <input matInput type="number" [(ngModel)]="nbrOfServings">
              </mat-form-field>
            </div>

            <div class="col-md-3">
              <button mat-raised-button color="primary" class="mtop-10" (click)="updateGroceryList()">Update Servings</button>
              <!-- <mat-spinner diameter="30" class="loading-indicator" *ngIf="isLoading"></mat-spinner> -->
            </div>
          </div>

          <div *ngIf="1 > gListToShow.length">
            <button *ngIf="!isLoading" mat-raised-button color="primary" (click)="createGroceryList()">
              Create Grocery List
            </button>
            <mat-spinner diameter="30" class="loading-indicator" *ngIf="isLoading"></mat-spinner>
          </div>

          <div class="alert alert-danger mtop-15" role="alert" *ngIf="groceryListCreateError">
            Something went wrong, please try again
          </div>

          <div class="alert alert-success mtop-15" role="alert" *ngIf="groceryListCreateSuccess">
            Grocery List Created successfully!
          </div>

          <div *ngIf="gListToShow.length > 0" #printContent>
            <table class="table table-striped table-hover" data-show-print="true">
              <thead>
                <tr class="">
                  <th scope="col">#</th>
                  <th scope="col">Food Name</th>
                  <th scope="col">Unit</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">Estimated Total Price (RWF)</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let food of gListToShow let i=index">
                  <th scope="row">{{i+1}}</th>
                  <td>{{food.food_name}}</td>
                  <td>{{food.unit}}</td>
                  <td>{{food.quantity}}</td>
                  <td>{{food.estimated_price}}</td>
                </tr>
                <tr>
                  <th scope="row"></th>
                  <td class="bold-text">TOTAL</td>
                  <td></td>
                  <td></td>
                  <td class="bold-text color-primary">{{glTotal}}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div *ngIf="gListToShow.length > 0" class="mtop-20">
            <button mat-raised-button color="primary" (click)="printGroceryList()">
              Print Grocery List
            </button>
          </div>

          <div class="mtop-20 noprint">
            <button *ngIf="!isLoading" mat-raised-button color="warn" (click)="deleteMealPlan()">
              Delete Meal Plan
            </button>
            <mat-spinner diameter="30" class="loading-indicator" *ngIf="isLoading"></mat-spinner>
          </div>
          
        </div>
      </div>
    </div>
  </div>
  <div class="new-recipe-btn-wrapper">
    <button mat-fab color="primary" aria-label="New meal plan" (click)="addNewMealPlan()">
      <mat-icon>add</mat-icon>
    </button>
  </div>
</div>